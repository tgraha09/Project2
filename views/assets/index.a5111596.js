var O=Object.defineProperty,W=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var S=(r,e,s)=>e in r?O(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s,w=(r,e)=>{for(var s in e||(e={}))x.call(e,s)&&S(r,s,e[s]);if(m)for(var s of m(e))R.call(e,s)&&S(r,s,e[s]);return r},C=(r,e)=>W(r,$(e));var F=(r,e)=>{var s={};for(var a in r)x.call(r,a)&&e.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&m)for(var a of m(r))e.indexOf(a)<0&&R.call(r,a)&&(s[a]=r[a]);return s};var y=(r,e,s)=>(S(r,typeof e!="symbol"?e+"":e,s),s);import{j as N,P as k,$ as h,R as p,B as T,S as L,a as d,b as A}from"./vendor.a8a93588.js";const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};q();const t=N.exports.jsx,l=N.exports.jsxs,g=N.exports.Fragment,f=s=>{var a=s,{backgroundColor:r}=a,e=F(a,["backgroundColor"]);return t("main",C(w({className:"main",style:r&&{backgroundColor:r}},e),{children:t("section",{className:"main-inner",children:e.children})}))};f.propTypes={backgroundColor:k.string,content:k.string.isRequired};f.defaultProps={backgroundColor:"rgb(25, 25, 51)",content:"Display"};var b=function(e,s,a,n){h.ajax({cache:!1,type:e,url:s,data:a,dataType:"json",success:n,error:function(o,u,c){console.log("Error"),console.log(o.responseText);var j=JSON.parse(o.responseText);console.log(j.error)}})};const E=(r,e)=>{let s,a=setInterval(function(){s=sessionStorage.getItem(r),s!=""&&s!=null&&(s=e(s),clearInterval(a))},200)},D=(r,e)=>{let s,a=setInterval(function(){return s=localStorage.getItem(r),s!=""&&s!=null&&(s=e(s),clearInterval(a)),s},200);return s};class I extends p.Component{constructor(e){super(e);console.log("SignupWindow"),this.state={username:"",pass:"",pass2:""},this.handleChange=this.handleChange.bind(this),this.handleSignup=this.handleSignup.bind(this)}handleChange(e){this.setState({[e.target.name]:e.target.value})}checkFields(){return!(this.state.username==""||this.state.pass==""||this.state.pass2=="")}checkPasswords(){return this.state.pass==this.state.pass2}createQuery(){const e=s=>encodeURIComponent(s.toString().trim());return`username=${e(this.state.username)}&pass=${e(this.state.pass)}&pass2=${e(this.state.pass2)}`}handleSignup(e){if(e.preventDefault(),!this.checkFields())return alert("RAWR! All fields are required!"),!1;if(!this.checkPasswords())return alert("RAWR! Passwords do not match!"),!1;const s="POST",a=document.querySelector("#signupForm").getAttribute("action"),n=this.createQuery();return console.log(n),b(s,a,n,()=>{window.location="/login"}),!1}render(){return l(g,{children:[t("h1",{className:"title",children:"Recipe Finder"}),l("nav",{className:"nav",children:[t("div",{className:"linkWrap",children:t("a",{className:"link",id:"login",href:"/login",children:"Login"})}),t("div",{className:"linkWrap",children:t("a",{className:"link",id:"signup",href:"/signup",children:"Signup"})})]}),t("h3",{className:"desc",children:"Search a recipe by its food and cuisine tag."}),t("div",{className:"content",children:l("form",{id:"signupForm",name:"signupForm",onSubmit:this.handleSignup,action:"/signup",method:"POST",className:"mainForm",children:[t("label",{htmlFor:"username",children:"Username: "}),t("input",{id:"user",type:"text",name:"username",placeholder:"username",value:this.state.username,onChange:this.handleChange}),t("label",{htmlFor:"pass",children:"Password: "}),t("input",{id:"pass",type:"password",name:"pass",placeholder:"password",value:this.state.pass,onChange:this.handleChange}),t("label",{htmlFor:"pass2",children:"Password: "}),t("input",{id:"pass2",type:"password",name:"pass2",placeholder:"retype password",value:this.state.pass2,onChange:this.handleChange}),t("input",{className:"formSubmit",type:"submit",value:"Sign up"})]})})]})}}class v extends p.Component{constructor(e){super(e);console.log("LoginWindow"),this.state={username:"",pass:""},this.handleChange=this.handleChange.bind(this),this.handleLogin=this.handleLogin.bind(this)}handleChange(e){this.setState({[e.target.name]:e.target.value})}checkFields(){return!(this.state.username==""||this.state.pass=="")}createQuery(){const e=s=>encodeURIComponent(s.toString().trim());return`username=${e(this.state.username)}&pass=${e(this.state.pass)}`}handleLogin(e){if(e.preventDefault(),!this.checkFields())return alert("RAWR! Username or password is empty"),!1;const s="POST",a=document.querySelector("#loginForm").getAttribute("action"),n=this.createQuery();return console.log(n),b(s,a,n,()=>{window.location="/finder"}),!1}render(){return l(g,{children:[t("h1",{className:"title",children:"Recipe Finder"}),l("nav",{className:"nav",children:[t("div",{className:"linkWrap",children:t("a",{className:"link",id:"login",href:"/login",children:"Login"})}),t("div",{className:"linkWrap",children:t("a",{className:"link",id:"signup",href:"/signup",children:"Signup"})})]}),t("h3",{className:"desc",children:"Search a recipe by its food and cuisine tag."}),t("div",{className:"content",children:l("form",{id:"loginForm",name:"loginForm",onSubmit:this.handleLogin,action:"/login",method:"POST",className:"mainForm",children:[t("label",{htmlFor:"username",children:"Username: "}),t("input",{id:"user",type:"text",name:"username",placeholder:"username",value:this.state.username,onChange:this.handleChange}),t("label",{htmlFor:"pass",children:"Password: "}),t("input",{id:"pass",type:"password",name:"pass",placeholder:"password",value:this.state.pass,onChange:this.handleChange}),t("input",{className:"formSubmit",type:"submit",value:"Sign in"})]})})]})}}class P extends p.Component{constructor(e){super(e);y(this,"search",e=>{let s=h(".tagInput"),n=h("#food").val(),i=s.val()||"american";sessionStorage.setItem("food",n),sessionStorage.setItem("tag",i);const o=searchform.getAttribute("action"),u=searchform.getAttribute("method");let c=o+`?&food=${n}&tag=${i}`;console.log(c),b(u,"/recipes-json",c,()=>{console.log({data:c}),console.log(`Send to ${o}`)}),setTimeout(()=>{window.location=`/recipes?&food=${n}&tag=${i}`},2e3)});console.log("Finder"),this.init()}init(){sessionStorage.removeItem("results"),(sessionStorage.getItem("tagsList")===null||sessionStorage.getItem("tagsList")==="")&&(console.log("Getting Tags"),this.getTags()),D("tagsList",e=>{let s=h("#recipeTags"),a=h("#tagInput");a.textContent="ok",a.recipeTags=[],h("#food"),h("#searchform"),JSON.parse(e).results.forEach(i=>{let o=i.name,u=i.display_name,c=document.createElement("option");c.id="tag",a.recipeTags[u]={tag:o,option:c},c.value=o,c.text=u,s.append(c)})})}getTags(){const e=null,s=new XMLHttpRequest;s.withCredentials=!1,s.addEventListener("readystatechange",function(){this.readyState===this.DONE&&sessionStorage.setItem("tagsList",this.responseText)}),s.open("GET","https://tasty.p.rapidapi.com/tags/list"),s.setRequestHeader("x-rapidapi-host","tasty.p.rapidapi.com"),s.setRequestHeader("x-rapidapi-key","170e038a70mshc48a677384b7b29p120f51jsn123cfd31d18c"),s.send(e)}render(){return l(g,{children:[t("h1",{className:"title",children:"Recipe Finder"}),l("nav",{className:"nav",children:[t("div",{className:"linkWrap",children:t("a",{className:"link",id:"logout",href:"/logout",children:"Logout"})}),t("div",{className:"linkWrap",children:t("a",{className:"link",id:"logout",href:"#",children:"Recipe Client"})})]}),t("h3",{className:"desc",children:"Search a recipe by its food and cuisine tag."}),t("div",{className:"content",children:t("form",{className:"mainForm",id:"searchform",method:"POST",action:"/recipes-json",children:l("div",{id:"formwrap",children:[l("div",{id:"foodWrap",children:[t("label",{htmlFor:"food",children:"Pick Food"}),t("br",{}),t("input",{className:"input",type:"text",id:"food",name:"food",defaultValue:"Chicken"}),t("br",{})]}),l("div",{id:"tagWrap",children:[t("label",{htmlFor:"tag",children:"Select Tag"}),t("br",{}),t("input",{className:"input",id:"tagInput",type:"text",name:"tag",list:"recipeTags"}),t("datalist",{name:"recipeTags",id:"recipeTags",children:t("option",{id:"tag"})})]}),t("input",{id:"submitbtn",type:"submit",onClick:e=>{e.preventDefault(),this.search(e)},onChange:()=>{console.log("Changed")}})]})})})]})}}class M extends p.Component{constructor(e){super(e);y(this,"handleResponse",(e,s,a)=>{console.log(e.target.response);let n=JSON.parse(e.target.response);console.log(n),sessionStorage.setItem("results",JSON.stringify(n))});console.log("Search"),this.init()}init(){(sessionStorage.getItem("results")===null||sessionStorage.getItem("results")==="")&&this.downloadRecipes(),E("results",e=>{this.displayRecipies(JSON.parse(e))})}downloadRecipes(){let e=new URL(document.location).searchParams,s=e.get("food"),a=e.get("tag");const n=`/recipes-json?food=${s}&tag=${a}`,i=new XMLHttpRequest;i.onload=o=>this.handleResponse(o,s,a),i.open("GET",n),i.setRequestHeader("Accept","application/javascript"),i.send()}render(){return l(g,{children:[t("h1",{className:"title",children:"Search Results"}),l("nav",{className:"nav",children:[t("div",{className:"linkWrap",children:t("a",{className:"link",id:"logout",href:"/logout",children:"Logout"})}),t("div",{className:"linkWrap",children:t("a",{className:"link",id:"logout",href:"#",children:"Recipe Client"})})]}),t("h3",{className:"desc",children:"Results"}),t("div",{className:"content",children:t("div",{id:"content"})})]})}displayRecipies(e){var n;console.log("Parsing Recipies");let s=document.querySelector("#content"),a=e.result;(n=a==null?void 0:a.results)==null||n.forEach(i=>{let o=document.createElement("recipe");o.innerHTML=`<img id="thumb" src=${i.thumbnail}> </img>
          <a href="javascript:void(0)" recipe="${i.id}" onclick="loadRecipe(this)">${i.name}</a>`,s.append(o)})}}class Q extends p.Component{constructor(e){super(e);console.log(e.csrf),this.state={csrf:e.csrf}}render(){return t(f,{children:t(T,{children:l(L,{children:[t(d,{exact:!0,path:"/",children:t(v,{csrf:this.state.csrf})}),t(d,{exact:!0,path:"/login",children:t(v,{csrf:this.state.csrf})}),t(d,{exact:!0,path:"/signup",children:t(I,{csrf:this.state.csrf})}),t(d,{exact:!0,path:"/finder",children:t(P,{csrf:this.state.csrf})})]})})})}}const U=r=>t(f,{children:t(T,{children:l(L,{children:[t(d,{exact:!0,path:"/",children:t(v,{})}),t(d,{exact:!0,path:"/login",children:t(v,{})}),t(d,{exact:!0,path:"/signup",children:t(I,{})}),t(d,{exact:!0,path:"/finder",children:t(P,{})}),t(d,{exact:!0,path:"/recipes",children:t(M,{})})]})})});A.render(t(p.StrictMode,{children:t(U,{})}),document.getElementById("root"));
